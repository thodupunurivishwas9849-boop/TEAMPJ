<!-- Admin Header -->
<header class="bg-white shadow-sm border-b">
  <div class="container mx-auto px-4 py-4">
    <div class="flex justify-between items-center">
      <div>
        <h1 class="text-2xl font-bold text-green-600">Yoga Management</h1>
        <p class="text-gray-600">Manage yoga poses and sessions</p>
      </div>
      <div class="flex space-x-3">
        <button
          (click)="openAddForm()"
          class="btn-primary">
          + Add New Yoga Pose
        </button>
        <button
          (click)="goBack()"
          class="btn-secondary">
          ‚Üê Dashboard
        </button>
      </div>
    </div>
  </div>
</header>

<div class="container mx-auto px-4 py-8">
  <!-- Add/Edit Form -->
  <div *ngIf="showForm" class="mb-8 card">
    <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
      <h2 class="text-lg font-semibold text-gray-800">
        {{isEditing ? 'Edit Yoga Pose' : 'Add New Yoga Pose'}}
      </h2>
    </div>

    <form class="p-6 space-y-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Name -->
        <div>
          <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
            Yoga Pose Name *
          </label>
          <input
            type="text"
            id="name"
            [(ngModel)]="formData.name"
            name="name"
            required
            class="input-primary"
            placeholder="Enter pose name">
        </div>

        <!-- Sanskrit Name -->
        <div>
          <label for="sanskritName" class="block text-sm font-medium text-gray-700 mb-2">
            Sanskrit Name (Optional)
          </label>
          <input
            type="text"
            id="sanskritName"
            [(ngModel)]="formData.sanskritName"
            name="sanskritName"
            class="input-primary"
            placeholder="Sanskrit name">
        </div>

        <!-- Pose Type -->
        <div>
          <label for="poseType" class="block text-sm font-medium text-gray-700 mb-2">
            Pose Type *
          </label>
          <select
            id="poseType"
            [(ngModel)]="formData.poseType"
            name="poseType"
            required
            class="input-primary">
            <option value="">Select Pose Type</option>
            <option *ngFor="let type of poseTypes" [value]="type">{{type}}</option>
          </select>
        </div>

        <!-- Difficulty -->
        <div>
          <label for="difficulty" class="block text-sm font-medium text-gray-700 mb-2">
            Difficulty Level *
          </label>
          <select
            id="difficulty"
            [(ngModel)]="formData.difficulty"
            name="difficulty"
            required
            class="input-primary">
            <option value="">Select Difficulty</option>
            <option *ngFor="let level of difficultyLevels" [value]="level">{{level}}</option>
          </select>
        </div>

        <!-- Duration -->
        <div class="md:col-span-2">
          <label for="duration" class="block text-sm font-medium text-gray-700 mb-2">
            Duration (minutes) *
          </label>
          <input
            type="number"
            id="duration"
            [(ngModel)]="formData.duration"
            name="duration"
            min="1"
            required
            class="input-primary"
            placeholder="Duration in minutes (default 30)">
        </div>
      </div>

      <!-- Description -->
      <div>
        <label for="description" class="block text-sm font-medium text-gray-700 mb-2">
          Description *
        </label>
        <textarea
          id="description"
          [(ngModel)]="formData.description"
          name="description"
          required
          rows="3"
          class="input-primary"
          placeholder="Describe the yoga pose and its purpose"></textarea>
      </div>

      <!-- Benefits -->
      <div>
        <label for="benefits" class="block text-sm font-medium text-gray-700 mb-2">
          Benefits * (comma separated)
        </label>
        <input
          type="text"
          id="benefits"
          [(ngModel)]="formData.benefits"
          name="benefits"
          required
          class="input-primary"
          placeholder="e.g. Improves flexibility, Reduces stress, Strengthens core">
        <p class="text-xs text-gray-500 mt-1">Separate multiple benefits with commas</p>
      </div>

      <!-- Instructions -->
      <div>
        <label for="instructions" class="block text-sm font-medium text-gray-700 mb-2">
          Instructions * (one per line)
        </label>
        <textarea
          id="instructions"
          [(ngModel)]="formData.instructions"
          name="instructions"
          required
          rows="8"
          class="input-primary font-mono text-sm"
          placeholder="1. Start in Mountain Pose (Tadasana)
2. Inhale and raise arms overhead
3. Exhale and fold forward from hips
4. Place hands on floor or fingertips to shins
5. Keep knees soft, lengthen spine
6. Breath deeply for 5 breaths"></textarea>
        <p class="text-xs text-gray-500 mt-1">Enter each step on a new line</p>
      </div>

      <!-- Error Message -->
      <div *ngIf="errorMessage" class="bg-red-50 border border-red-200 rounded-md p-3">
        <p class="text-red-600 text-sm">{{errorMessage}}</p>
      </div>

      <!-- Buttons -->
      <div class="flex justify-end space-x-3">
        <button
          type="button"
          (click)="cancelEdit()"
          class="btn-secondary">
          Cancel
        </button>
        <button
          type="button"
          (click)="saveYoga()"
          [disabled]="isSubmitting"
          class="btn-primary disabled:opacity-50 disabled:cursor-not-allowed">
          <span *ngIf="isSubmitting" class="inline-block mr-2">
            <svg class="animate-spin h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
          </span>
          {{isSubmitting ? 'Saving...' : (isEditing ? 'Update Yoga Pose' : 'Add Yoga Pose')}}
        </button>
      </div>
    </form>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading && !showForm" class="flex justify-center items-center py-12">
    <div class="w-8 h-8 animate-spin rounded-full border-4 border-green-200 border-t-green-600"></div>
    <span class="ml-3 text-gray-600">Loading yoga poses...</span>
  </div>

  <!-- Error Message for loading -->
  <div *ngIf="errorMessage && !showForm" class="bg-red-50 border border-red-200 rounded-md p-4 mb-6">
    <p class="text-red-600">{{errorMessage}}</p>
    <button
      (click)="loadYoga()"
      class="mt-2 btn-primary text-sm">
      Try Again
    </button>
  </div>

  <!-- Yoga List -->
  <div *ngIf="!isLoading && !showForm" class="card">
    <!-- Table Header -->
    <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
      <h2 class="text-lg font-semibold text-gray-800">All Yoga Poses ({{yoga.length}})</h2>
    </div>

    <div *ngIf="yoga.length === 0" class="text-center py-12">
      <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13m-7 8l-4-4m3 4v4m-3.5-6h7"></path>
      </svg>
      <p class="mt-4 text-gray-500">No yoga poses added yet</p>
      <button
        (click)="openAddForm()"
        class="mt-4 btn-primary">
        Add First Yoga Pose
      </button>
    </div>

    <div *ngIf="yoga.length > 0" class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Yoga Pose
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Type & Difficulty
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Duration
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Benefits
            </th>
            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
              Actions
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let pose of yoga" class="hover:bg-gray-50">
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex flex-col">
                <div class="text-sm font-medium text-gray-900">{{pose.name}}</div>
                <div *ngIf="pose.sanskritName" class="text-xs text-purple-600 italic">
                  {{pose.sanskritName}}
                </div>
                <div class="text-sm text-gray-500 truncate max-w-xs mt-1">
                  {{pose.description}}
                </div>
                <div class="text-xs text-gray-400 mt-1">
                  {{pose.instructions.length}} steps
                </div>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex flex-col space-y-1">
                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800 w-fit">
                  {{pose.poseType}}
                </span>
                <span [class]="pose.difficulty === 'Beginner' ? 'text-green-600' :
                               pose.difficulty === 'Intermediate' ? 'text-yellow-600' :
                               'text-red-600'"
                      class="text-xs font-medium">
                  {{pose.difficulty}}
                </span>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
              {{pose.duration}} min
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-900 max-w-xs truncate">
                {{pose.benefits.slice(0, 2).join(', ')}}
                <span *ngIf="pose.benefits.length > 2">...</span>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
              <div class="flex justify-end space-x-2">
                <button
                  (click)="editYoga(pose)"
                  class="text-blue-600 hover:text-blue-900 bg-blue-50 hover:bg-blue-100 px-3 py-1 rounded-md transition-colors">
                  Edit
                </button>
                <button
                  (click)="deleteYoga(pose)"
                  class="text-red-600 hover:text-red-900 bg-red-50 hover:bg-red-100 px-3 py-1 rounded-md transition-colors">
                  Delete
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
